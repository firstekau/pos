var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},n3Charts;!function(e){var t;!function(e){function t(){function e(e,t,n){e.attr("transform",function(e){var r=t(e.value);return"translate("+(isFinite(r)?r:n(e.value))+",0)"})}function t(e,t,n){e.attr("transform",function(e){var r=t(e.value);return"translate(0,"+(isFinite(r)?r:n(e.value))+")"})}function n(e){var t=e[0],n=e[e.length-1];return n>t?[t,n]:[n,t]}function r(e){return e.rangeExtent?e.rangeExtent():n(e.range())}var i,s=([].slice,"bottom"),o={top:1,right:1,bottom:1,left:1},u=d3.scale.linear(),a=s,f=6,l=24,c=-6,h=0,p=5,d=null,v=null,m=function(n,s,o,u,d){var v,m="major"===s,g=m?l:h,y=m?c:p,b=d.selectAll(".tick."+s).data(n,function(e){return u(e.value)}),w=b.enter().insert("g",".domain").attr("class","tick "+s).style("opacity",1e-6),E=d3.transition(b.exit()).style("opacity",1e-6).remove(),S=d3.transition(b.order()).style("opacity",1),x=Math.max(g,0)+y,T=r(u),N=d.selectAll(".domain").data([0]),C=(N.enter().append("path").attr("class","domain"),N.transition());w.append("line"),w.append("text");var k,L,A,O,M=w.select("line"),_=S.select("line"),D=b.select("text").text(function(e,t){return i?i(e,t):e.label}),P=w.select("text"),H=S.select("text"),B="top"===a||"left"===a?-1:1;"bottom"===a||"top"===a?(v=e,k="x",A="y",L="x2",O="y2",D.attr({dy:0>B?"0em":".8em",dx:"5px"}).style("text-anchor","left"),C.attr("d","M"+T[0]+","+B*f+"V0H"+T[1]+"V"+B*f)):(v=t,k="y",A="x",L="y2",O="x2",D.attr({dy:".32em",dx:0>B?-x+"px":x+"px"}).style("text-anchor",0>B?"end":"start"),C.attr("d","M"+B*f+","+T[0]+"H0V"+T[1]+"H"+B*f)),M.attr(O,B*g),P.attr(A,B*x),_.attr(L,0).attr(O,B*g),H.attr(k,0).attr(A,B*x),E.call(v,u,o),w.call(v,o,u),S.call(v,u,u)},g=function(e){e.each(function(){var e=d3.select(this),t=this.__chart__||u,n=this.__chart__=u.copy(),r=d(n.domain()),i=r.major,s=r.minor;m(i,"major",t,n,e),m(s,"minor",t,n,e)})};return g.scale=function(e){return arguments.length?(u=e,g):u},g.orient=function(e){return arguments.length?(a=e in o?e+"":s,g):a},g.ticks=function(e){return arguments.length?(d=e,g):d},g.tickValues=function(e){return arguments.length?(v=e,g):v},g.tickFormat=function(e){return arguments.length?(i=e,g):i},g.tickSize=function(e){var t=arguments.length;return t?(l=+e,f=+arguments[t-1],h=+e,g):l},g.innerTickSize=function(e){return arguments.length?(l=+e,g):l},g.outerTickSize=function(e){return arguments.length?(f=+e,g):f},g.tickPadding=function(e){return arguments.length?(c=+e,g):c},g}e.twoSpeedAxis=t}(t=e.svg||(e.svg={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(t){var n=function(){function n(t){void 0===t&&(t={}),this.axis="y",this.type=["line"],this.visible=!0,this.defined=function(e){return!0};var n=this.sanitizeOptions(t);this.id=n.id||e.Utils.UUID.generate(),this.axis=n.axis,this.interpolation=n.interpolation,this.dataset=n.dataset,this.key=n.key,this.color=n.color,this.visible=n.visible,this.label=n.label||n.id,n.defined&&(this.defined=n.defined),n.type.length>0&&(this.type=this.sanitizeType(n.type))}return n.prototype.sanitizeOptions=function(e){var n={};return angular.extend(n,this,e),n.axis=this.sanitizeAxis(n.axis),n.interpolation=this.sanitizeInterpolation(n.interpolation),n.id=t.Options.getString(n.id),n.type=t.Options.getArray(n.type),n.dataset=t.Options.getString(n.dataset),n.key=this.sanitizeKeys(n.key),n.color=t.Options.getString(n.color),n.label=t.Options.getString(n.label),n.visible=t.Options.getBoolean(n.visible),n.defined=t.Options.getFunction(n.defined),n},n.prototype.sanitizeInterpolation=function(e){return e?{mode:t.Options.getString(e.mode,"linear"),tension:t.Options.getNumber(e.tension,.7)}:{mode:"linear",tension:.7}},n.prototype.sanitizeKeys=function(e){return e?"string"==typeof e?{y1:t.Options.getString(e)}:{y0:t.Options.getString(e.y0),y1:t.Options.getString(e.y1)}:{y1:void 0}},n.prototype.getToggledVisibility=function(){return!this.visible},n.prototype.sanitizeType=function(e){return e.filter(function(e){return n.isValidType(e)?!0:(console.warn("Unknow series type : "+e),!1)})},n.prototype.sanitizeAxis=function(e){if(-1===["y","y2"].indexOf(e))throw TypeError(e+" is not a valid series option for axis.");return e},n.prototype.isAColumn=function(){return this.hasType(n.TYPE.COLUMN)},n.prototype.isDashed=function(){return-1!==this.type.indexOf(n.TYPE.DASHED_LINE)},n.prototype.hasType=function(e){return e===n.TYPE.LINE?-1!==this.type.indexOf(e)||-1!==this.type.indexOf(n.TYPE.DASHED_LINE):-1!==this.type.indexOf(e)},n.prototype.hasTwoKeys=function(){return void 0!==this.key.y0},n.isValidType=function(e){return-1!==d3.values(n.TYPE).indexOf(e)},n.TYPE={DOT:"dot",LINE:"line",DASHED_LINE:"dashed-line",AREA:"area",COLUMN:"column"},n}();t.SeriesOptions=n}(t=e.Options||(e.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(e){var t=function(){function t(e){void 0===e&&(e={}),this.includeZero=!1,this.type="linear",this.key="x",this.padding={min:0,max:0},this.ticksShift={x:0,y:0},this.parse(e)}return t.prototype.parse=function(n){this.type=e.Options.getString(n.type,"linear"),this.key=n.key,this.padding=e.Options.getObject(n.padding||{},this.padding),this.includeZero=e.Options.getBoolean(n.includeZero,!1),this.tickFormat=e.Options.getFunction(n.tickFormat),this.ticks=n.ticks,n.ticksShift&&(this.ticksShift={x:e.Options.getNumber(n.ticksShift.x,0),y:e.Options.getNumber(n.ticksShift.y,0)}),this.type===t.TYPE.LINEAR?(this.min=e.Options.getNumber(n.min,void 0),this.max=e.Options.getNumber(n.max,void 0)):this.type===t.TYPE.DATE&&(this.min=e.Options.getDate(n.min,void 0),this.max=e.Options.getDate(n.max,void 0))},t.isValidSide=function(e){return-1!==d3.values(t.SIDE).indexOf(e)},t.prototype.hasDynamicTicks=function(){return this.ticks instanceof Function},t.prototype.configure=function(e){return e.tickFormat(this.tickFormat),this.ticks instanceof Array?e.tickValues(this.ticks):"number"==typeof this.ticks?e.ticks(this.ticks):this.ticks instanceof Function&&e.ticks(this.ticks),e},t.SIDE={X:"x",X2:"x2",Y:"y",Y2:"y2"},t.TYPE={LINEAR:"linear",DATE:"date",LOG:"log"},t}();e.AxisOptions=t}(t=e.Options||(e.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(e){var t=function(){function t(){this.width=600,this.height=200,this.innerWidth=560,this.innerHeight=160,this.margin=t.getDefaultMargins()}return t.getDefaultMargins=function(){return{top:0,left:40,bottom:40,right:40}},t.prototype.updateMargins=function(t){var n=this;if(t&&t.margin){var r=function(r){return n.margin[r]=e.Options.getNumber(t.margin[r],n.margin[r])};r("top"),r("bottom"),r("left"),r("right")}},t.prototype.getDimensionByProperty=function(e,t){var n=window.getComputedStyle(e,null);return+n.getPropertyValue(t).replace(/px$/,"")},t.prototype.fromParentElement=function(e){if(e){var t=this.getDimensionByProperty(e,"padding-left")+this.getDimensionByProperty(e,"padding-right"),n=this.getDimensionByProperty(e,"padding-top")+this.getDimensionByProperty(e,"padding-bottom");this.width=e.clientWidth-t,this.height=e.clientHeight-n,this.innerHeight=this.height-this.margin.top-this.margin.bottom,this.innerWidth=this.width-this.margin.left-this.margin.right}},t}();e.Dimensions=t}(t=e.Options||(e.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(e){var t=function(){function t(n){this.doubleClickEnabled=!0,this.series=[],this.pan={x:!1,y:!1},this.zoom={x:!1,y:!1},this.axes={x:{},y:{}},this.margin=e.Dimensions.getDefaultMargins(),this.grid={x:!1,y:!0};var r=angular.extend({},this,n);this.margin=this.sanitizeMargin(t.getObject(r.margin,this.margin)),this.series=this.sanitizeSeries(t.getArray(r.series)),this.axes=this.sanitizeAxes(t.getObject(r.axes,this.axes)),this.grid=this.sanitizeTwoAxesOptions(r.grid,this.grid),this.pan=this.sanitizeTwoAxesOptions(r.pan,this.pan),this.zoom=this.sanitizeTwoAxesOptions(r.zoom,this.zoom),this.tooltipHook=t.getFunction(r.tooltipHook),this.doubleClickEnabled=t.getBoolean(r.doubleClickEnabled,!1)}return t.prototype.sanitizeMargin=function(e){return{top:t.getNumber(e.top,0),left:t.getNumber(e.left,0),bottom:t.getNumber(e.bottom,0),right:t.getNumber(e.right,0)}},t.prototype.sanitizeSeries=function(t){return t.map(function(t){return new e.SeriesOptions(t)})},t.prototype.sanitizeTwoAxesOptions=function(e,n){var r={x:t.getBoolean(e.x,n.x),y:t.getBoolean(e.y,n.y)};return r},t.prototype.sanitizeAxes=function(t){return Object.keys(t).reduce(function(n,r){return n[r]=new e.AxisOptions(t[r]),n},{})},t.prototype.getAbsKey=function(){if(!this.axes[e.AxisOptions.SIDE.X])throw new TypeError("Cannot find abs key : "+e.AxisOptions.SIDE.X);return this.axes[e.AxisOptions.SIDE.X].key},t.prototype.getVisibleDatasets=function(){var e=[];return this.series.forEach(function(t){t.visible&&-1===e.indexOf(t.dataset)&&e.push(t.dataset)}),e},t.prototype.getVisibleSeriesBySide=function(e){return this.series.filter(function(t){return t.visible&&t.axis===e})},t.prototype.getSeriesAndDatasetBySide=function(t){if(!e.AxisOptions.isValidSide(t))throw new TypeError("Cannot get axis side : "+t);t!==e.AxisOptions.SIDE.Y2||this.axes[t]||(t=e.AxisOptions.SIDE.Y);var n=[],r={};return this.series.forEach(function(e){e.visible&&e.axis===t&&(n.push(e.dataset),r[e.dataset]||(r[e.dataset]=[]),r[e.dataset].push(e))}),{seriesForDataset:r,datasetsForSide:n}},t.prototype.getByAxisSide=function(t){if(!e.AxisOptions.isValidSide(t))throw new TypeError("Cannot get axis side : "+t);if(!this.axes[t]){if(t===e.AxisOptions.SIDE.Y2)return this.axes[e.AxisOptions.SIDE.Y];if(t===e.AxisOptions.SIDE.X2)return this.axes[e.AxisOptions.SIDE.X]}return this.axes[t]},t.prototype.getSeriesByType=function(t){if(!e.SeriesOptions.isValidType(t))throw new TypeError("Unknown series type: "+t);return this.series.filter(function(e){return e.hasType(t)})},t.getBoolean=function(e,t){return void 0===t&&(t=!0),"boolean"==typeof e?e:t},t.getNumber=function(e,t){var n=parseFloat(e);return isNaN(n)?t:n},t.getDate=function(e,t){return e instanceof Date?e:t},t.getFunction=function(e){return e instanceof Function?e:void 0},t.getString=function(e,t){return e?String(e):t},t.getIdentifier=function(e){var n=t.getString(e);return n.replace(/[^a-zA-Z0-9\-_]/gi,"")},t.getObject=function(e,t){if(void 0===t&&(t={}),!angular.isObject(e))throw TypeError(e+" option must be an object.");var n={};return angular.extend(n,t,e),n},t.getArray=function(e,t){return void 0===t&&(t=[]),t.concat(e)},t}();e.Options=t}(t=e.Options||(e.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(e){var t=function(){function e(){this.strictMode=!0}return e.prototype.init=function(e){var t=this;this._dispatch=d3.dispatch.apply(this,e);var n=(new Date).getTime();return d3.select(window).on("mouseup."+n,function(){t.trigger("window-mouseup")}),d3.select(window).on("mousemove."+n,function(){t.trigger("window-mousemove")}),this},e.prototype.update=function(e,t){this.data=e,this.options=t},e.prototype.on=function(t,n){if(this.strictMode&&-1===e.EVENTS.indexOf(t.split(".")[0]))throw new Error("Unknown event: "+t);return this._dispatch.on(t,n),this},e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._dispatch[e].apply(this,t),this},e.prototype.triggerDataAndOptions=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.push(this.data),t.push(this.options),this._dispatch[e].apply(this,t),this},e.prototype.datumEnter=function(e,t){var n=this;return function(r){return r.on("mouseenter",function(r,s){n.trigger("enter",r,s,e,t)})}},e.prototype.datumOver=function(e,t){var n=this;return function(r){return r.on("mouseover",function(r,s){n.trigger("over",r,s,e,t)})}},e.prototype.datumMove=function(e,t){var n=this;return function(r){return r.on("mousemove",function(r,s){n.trigger("over",r,s,e,t)})}},e.prototype.datumLeave=function(e,t){var n=this;return function(r){return r.on("mouseleave",function(r,s){n.trigger("leave",r,s,e,t)})}},e.prototype.listenForDblClick=function(e,t,n){var r,i,s=this,o=5,u=null,a=function(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))};return e.on("mousedown.dbl."+n,function(){r=d3.mouse(document.body),i=(new Date).getTime()}),e.on("mouseup.dbl."+n,function(){!r||a(r,d3.mouse(document.body))>o||(u&&s.options.doubleClickEnabled?(window.clearTimeout(u),u=null,t(d3.event)):u=window.setTimeout(function(e){return function(){u=null}}(d3.event),300))}),e},e.EVENTS=["create","update","data-update","resize","destroy","enter","over","move","leave","click","dblclick","legend-click","legend-over","legend-out","container-over","container-move","container-out","focus","toggle","outer-world-hover","outer-world-domain-change","pan","pan-end","zoom","zoom-end","zoom-pan-reset","window-mouseup","window-mousemove"],e}();e.EventManager=t}(t=e.Utils||(e.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(e){var t=function(){function e(){this._factoryStack=[]}return e.prototype.index=function(e){return this._factoryStack.map(function(e){return e.key}).indexOf(e)},e.prototype.getBoundFunction=function(e,t){var n=this.get(e);return n?n[t].bind(n):null},e.prototype.get=function(e){var t=this.index(e);return t>-1?this._factoryStack[t].instance:null},e.prototype.all=function(){return this._factoryStack},e.prototype.turnFactoriesOff=function(e){var t=this,n=[];return e.forEach(function(e){var r=t.get(e);r.isOn()&&(r.off(),n.push(e))}),function(){return t.turnFactoriesOn(n)}},e.prototype.turnFactoriesOn=function(e){var t=this,n=[];return e.forEach(function(e){var r=t.get(e);r.isOff()&&(r.on(),n.push(e))}),function(){return t.turnFactoriesOff(n)}},e.prototype.registerMany=function(e){var t=this;return e.forEach(function(e){t.register.apply(t,e)}),this},e.prototype.register=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=t.bind.apply(t,[null].concat(n)),s=new i;return this._factoryStack.push({key:e,instance:s}),s},e.prototype.unregister=function(e){var t=this.index(e);return t>-1&&delete this._factoryStack[t],this},e}();e.FactoryManager=t}(t=e.Utils||(e.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(e){var t=function(){function e(e,t){this.fromJS(e,t)}return e.prototype.fromJS=function(e,t){this.id=t,this.values=e},e}();e.Dataset=t}(t=e.Utils||(e.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(e){var t=function(){function t(e){e&&this.fromJS(e)}return t.prototype.fromJS=function(t){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=new e.Dataset(t[r],r));this.sets=n},t.prototype.getDatasets=function(e,t){var n=this;return e.map(function(e){return n.getDatasetValues(e,t)})},t.prototype.getDatasetValues=function(e,t){if(!this.sets||!this.sets[e.dataset].values)return[];var n,r=t.getAbsKey();return n=e.key.y0?function(t){return{x:t[r],y1:t[e.key.y1],y0:t[e.key.y0]}}:function(t){return{x:t[r],y1:t[e.key.y1],y0:0}},this.sets[e.dataset].values.map(n)},t.getMinDistance=function(e,t,n,r){return void 0===n&&(n="x"),d3.min(e.map(function(e){return e.map(function(e){return t.scale(e[n])}).filter(function(e){return r?e>=r[0]&&e<=r[1]:!0}).reduce(function(e,t,n,r){var i=n>0?t-r[n-1]:Number.MAX_VALUE;return e>i?i:e},Number.MAX_VALUE)}))},t}();e.Data=t}(t=e.Utils||(e.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(e){var t=function(){function e(){}return e.debounce=function(e,t){var n=this,r=null;return function(){for(var s=[],o=0;o<arguments.length;o++)s[o-0]=arguments[o];r&&window.clearTimeout(r),r=window.setTimeout(function(){return e.apply(n,s)},t)}},e}();e.FunctionUtils=t;var n=function(){function e(){}return e.generate=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)})},e}();e.UUID=n}(t=e.Utils||(e.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(e){var t=function(){function e(){this.enabled=!0}return e.prototype.init=function(e,t,n){this.key=e,this.eventMgr=t,this.factoryMgr=n,this.eventMgr.on("create."+this.key,this.create.bind(this)),this.eventMgr.on("update."+this.key,this.update.bind(this)),this.eventMgr.on("destroy."+this.key,this.destroy.bind(this))},e.prototype.on=function(){this.enabled=!0},e.prototype.off=function(){this.enabled=!1},e.prototype.isOn=function(){return this.enabled===!0},e.prototype.isOff=function(){return this.enabled===!1},e.prototype.create=function(e){},e.prototype.update=function(e,t){},e.prototype.destroy=function(){},e}();e.BaseFactory=t}(t=e.Factory||(e.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(t){var n=function(t){function n(n){t.call(this),this.element=n,this.dim=new e.Options.Dimensions}return __extends(n,t),n.prototype.create=function(e){var t=this;this.dim.updateMargins(e),this.listenToElement(this.element,e),this.createRoot(),this.createContainer(),this.dim.fromParentElement(this.element.parentElement),this.eventMgr.on("resize",function(){t.dim.fromParentElement(t.element.parentElement),t.update()}),this.eventMgr.listenForDblClick(this.svg,function(){t.eventMgr.trigger("zoom-pan-reset",!0)},this.key),this.eventMgr.on("zoom-pan-reset."+this.key,function(e){t.eventMgr.triggerDataAndOptions("update")})},n.prototype.listenToElement=function(e,t){var n=this.eventMgr;e.addEventListener("mouseover",function(e){n.triggerDataAndOptions.apply(n,["container-over",e])}),e.addEventListener("mousemove",function(e){n.triggerDataAndOptions.apply(n,["container-move",e])}),e.addEventListener("mouseout",function(e){n.triggerDataAndOptions.apply(n,["container-out",e])})},n.prototype.getCoordinatesFromEvent=function(e){var t=this.getDimensions(),n=e.currentTarget.getBoundingClientRect(),r=n.left,i=n.top,s=this.factoryMgr.get("x-axis"),o=s.invert(e.clientX-r-t.margin.left),u=this.factoryMgr.get("y-axis"),a=u.invert(e.clientY-i-t.margin.top);return{y:a,x:o}},n.prototype.update=function(){this.updateRoot(),this.updateContainer()},n.prototype.destroy=function(){this.destroyRoot()},n.prototype.createRoot=function(){this.svg=d3.select(this.element).append("svg").attr("class","chart"),this.defs=this.svg.append("defs")},n.prototype.updateRoot=function(){this.svg.attr("width",this.dim.width).attr("height",this.dim.height)},n.prototype.destroyRoot=function(){this.svg.remove()},n.prototype.createContainer=function(){this.vis=this.svg.append("g").attr("class","container"),this.axes=this.vis.append("g").attr("class","axes"),this.clippingPathId="clipping-path-"+e.Utils.UUID.generate(),this.defs.append("svg:clipPath").attr("id",this.clippingPathId).append("svg:rect").attr("id","clipping-rect"),this.data=this.vis.append("g").attr({"class":"data","clip-path":"url(#"+this.clippingPathId+")"}),this.overlay=this.vis.append("g").attr("class","overlay")},n.prototype.updateContainer=function(){this.vis.attr({width:this.dim.innerWidth,height:Math.max(this.dim.innerHeight,0),transform:"translate("+this.dim.margin.left+", "+this.dim.margin.top+")"}),d3.select(this.element).select("#clipping-rect").attr({width:Math.max(this.dim.innerWidth,0),height:Math.max(this.dim.innerHeight,0)})},n.prototype.getDimensions=function(){return this.dim},n}(t.BaseFactory);t.Container=n}(t=e.Factory||(e.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(t){var n=function(t){function n(e){t.call(this),this.element=e}return __extends(n,t),n.prototype.off=function(){t.prototype.off.call(this),this.hide()},n.prototype.create=function(e){this.options=e,this.createTooltip(),this.eventMgr.on("container-move.tooltip",this.show.bind(this)),this.eventMgr.on("container-out.tooltip",this.hide.bind(this)),this.eventMgr.on("outer-world-hover.tooltip",this.showFromCoordinates.bind(this)),this.hide()},n.prototype.update=function(e,t){this.options=t},n.prototype.createTooltip=function(){var e=this.svg=d3.select(this.element).append("div").attr("class","chart-tooltip");e.append("div").attr("class","abscissas"),this.line=this.factoryMgr.get("container").overlay.append("line").attr("class","tooltip-line"),this.dots=this.factoryMgr.get("container").overlay.append("g").attr("class","tooltip-dots")},n.prototype.destroy=function(){this.svg.remove()},n.prototype.getClosestRows=function(e,t,n){for(var r=n.series.filter(function(e){return e.visible}),i=r.map(function(e){return t.getDatasetValues(e,n).filter(e.defined)}),s=[],o=-1,u=Number.POSITIVE_INFINITY,a=[],f=0;f<i.length;f++)for(var l=0;l<i[f].length;l++){if("date"===n.axes.x.type)var c=Math.abs(i[f][l].x.getTime()-e);else var c=Math.abs(i[f][l].x-e);var h=r[f];c===u&&-1===a.indexOf(h)?(s.push({series:h,row:i[f][l]}),a.push(h)):u>c&&(u=c,s=[{series:r[f],row:i[f][l]}],a=[h],o=l)}return{rows:s,index:o}},n.prototype.showFromCoordinates=function(e,t,n){if(!this.isOff()){var r=e.x,i=e.y;if(void 0===r||void 0===i)return void this.hide(void 0,t,n);r instanceof Date&&(r=r.getTime());var s=this.getClosestRows(r,t,n),o=s.rows,u=s.index;if(0===o.length)return void this.hide(void 0,t,n);this.updateTooltipDots(o),this.dots.style("opacity","1"),this.updateLinePosition(o),this.line.style("opacity","1");var a=this.getTooltipContent(o,u,n);n.tooltipHook&&(a=n.tooltipHook(o)),a&&(this.updateTooltipContent(a,u,n),this.updateTooltipPosition(o),this.svg.style("display",null))}},n.prototype.show=function(e,t,n){if(!this.isOff()){var r=this.factoryMgr.get("container"),i=r.getCoordinatesFromEvent(e);this.showFromCoordinates(i,t,n)}},n.prototype.hide=function(e,t,n){this.svg.style("display","none"),this.line.style("opacity","0"),this.dots.style("opacity","0"),n&&n.tooltipHook&&n.tooltipHook(void 0)},n.prototype.getTooltipContent=function(t,n,r){var i=r.getByAxisSide(e.Options.AxisOptions.SIDE.X).tickFormat,s=function(e){return r.getByAxisSide(e).tickFormat},o=function(e){var t=s(e.series.axis),r=t?function(e){return t(e,n)}:function(e){return e},i=r(e.row.y1);return e.series.hasTwoKeys()?"["+r(e.row.y0)+", "+i+"]":i};return{abscissas:i?i(t[0].row.x,n):t[0].row.x,rows:t.map(function(e){return{label:e.series.label,value:o(e),color:e.series.color,id:e.series.id}})}},n.prototype.updateTooltipContent=function(e,t,n){this.svg.select(".abscissas").text(e.abscissas);var r=function(e){return e.attr({"class":"tooltip-item"}),e.append("div").attr({"class":"color-dot"}).style({"background-color":function(e){return e.color}}),e.append("div").attr({"class":"series-label"}),e.append("div").attr({"class":"y-value"}),e},i=function(e){return e.select(".series-label").text(function(e){return e.label}),e.select(".y-value").text(function(e){return e.value}),e},s=this.svg.selectAll(".tooltip-item").data(e.rows,function(e,t){return e.id?e.id:t});s.enter().append("div").call(r).call(i),s.call(i),s.exit().remove()},n.prototype.updateTooltipDots=function(e){var t=this,n=this.factoryMgr.get("x-axis").scale,r=function(e){return t.factoryMgr.get(e+"-axis").scale},i=3,s=function(e,t,n){return"M "+t+" "+n+" m -"+e+", 0 a "+e+","+e+" 0 1,0 "+2*e+",0 a "+e+","+e+" 0 1,0 -"+2*e+",0 "},o=function(e){e.attr("class","tooltip-dots-group"),e.append("path").attr({"class":"tooltip-dot y1"}).on("click",function(e,n){t.eventMgr.trigger("click",e.row,n,e.series,t.options)}),e.append("path").attr({"class":"tooltip-dot y0"}).style({display:function(e){return e.series.hasTwoKeys()?null:"none"}}).on("click",function(e,n){t.eventMgr.trigger("click",e.row,n,e.series,t.options)})},u=function(e){e.select(".tooltip-dot.y1").attr({d:function(e){return s(i,n(e.row.x),r(e.series.axis)(e.row.y1))},stroke:function(e){return e.series.color}}),e.select(".tooltip-dot.y0").attr({d:function(e){return e.series.hasTwoKeys()?s(i,n(e.row.x),r(e.series.axis)(e.row.y0)):""},stroke:function(e){return e.series.color}})},a=this.dots.selectAll(".tooltip-dots-group").data(e);a.enter().append("g").call(o).call(u),a.call(u),a.exit().remove()},n.prototype.updateTooltipPosition=function(e){var t=e.slice(-1)[0],n=this.factoryMgr.get("x-axis"),r=(this.factoryMgr.get("y-axis").scale,this.factoryMgr.get("container").getDimensions().margin),i=this.element.offsetLeft,s=this.element.offsetTop,o=0,u="";n.isInLastHalf(t.row.x)?(u="translate(-100%, 0)",o=-10):o=10,this.svg.style({left:i+r.left+n.scale(t.row.x)+o+"px",top:s+r.top+"px",transform:u})},n.prototype.updateLinePosition=function(e){var t=this.factoryMgr.get("container"),n=t.getDimensions(),r=e.slice(-1)[0],i=this.factoryMgr.get("x-axis"),s=i.scale(r.row.x);this.line.attr({x1:s,x2:s,y1:-n.margin.top,y2:n.innerHeight})},n}(t.BaseFactory);t.Tooltip=n}(t=e.Factory||(e.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(e){var t=function(e){function t(t){e.call(this),this.element=t}return __extends(t,e),t.prototype.create=function(){this.createLegend()},t.prototype.createLegend=function(){this.div=d3.select(this.element).append("div").attr("class","chart-legend").style("position","absolute")},t.prototype.legendClick=function(){var e=this;return function(t){return t.on("click",function(t){e.eventMgr.trigger("legend-click",t)})}},t.prototype.update=function(e,t){var n=this,r=this.factoryMgr.get("container"),i=(r.getDimensions(),function(e){var t=e.append("div").attr({"class":"item"}).call(n.legendClick());t.append("div").attr({"class":"icon"}),t.append("div").attr({"class":"legend-label"})}),s=function(e){e.attr("class",function(e){return"item "+e.type.join(" ")}).classed("legend-hidden",function(e){return!e.visible}),e.select(".icon").style("background-color",function(e){return e.color}),e.select(".legend-label").text(function(e){return e.label})},o=this.div.selectAll(".item").data(t.series);o.enter().call(i),o.call(s),o.exit().remove()},t.prototype.destroy=function(){this.div.remove()},t}(e.BaseFactory);e.Legend=t}(t=e.Factory||(e.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(t){var n=function(t){function n(n){var r=this;if(t.call(this),this.side=n,!e.Options.AxisOptions.isValidSide(n))throw new TypeError("Wrong axis side : "+n);this.scale=function(e){return r._scale.call(r,e)}}return __extends(n,t),n.prototype.range=function(){return this._scale.range()},n.prototype.getDomain=function(){return this._scale.domain()},n.prototype.setDomain=function(e){return this._scale.domain.call(this,e)},n.prototype.create=function(){var e=this.factoryMgr.get("container").axes;this.createAxis(e),this.eventMgr.on("pan."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("zoom-end."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("outer-world-domain-change."+this.key,this.updateFromOuterWorld.bind(this)),this.eventMgr.on("resize."+this.key,this.onResize.bind(this))},n.prototype.updateFromOuterWorld=function(e){this.updateScaleDomain(e[this.side[0]]),this.softUpdate()},n.prototype.softUpdate=function(){this.factoryMgr.get("transitions").isOn()?this.svg.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(this.d3axis):this.svg.call(this.d3axis)},n.prototype.onResize=function(){var e=this.factoryMgr.get("container"),t=e.getDimensions();this.updateScaleRange(t,this.options),this.updateAxisContainer(t),this.softUpdate()},n.prototype.getDimensions=function(){var e=this.factoryMgr.get("container");return e.getDimensions()},n.prototype.update=function(e,t){var n=this.getDimensions(),r=this.getExtent(e,t);this.options=t.getByAxisSide(this.side),this._scale=this.getScale(),this.updateScaleRange(n,this.options),this.updateScaleDomain(r),this.d3axis=this.getAxis(this._scale,this.options),this.updateAxisOrientation(this.d3axis),this.updateAxisContainer(n),this.shiftAxisTicks(this.options)},n.prototype.shiftAxisTicks=function(e){var t=e.ticksShift,n=t.x,r=t.y;this.svg.selectAll("text").attr("transform","translate("+n+", "+r+")")},n.prototype.destroy=function(){this.destroyAxis()},n.prototype.updateScaleRange=function(e,t){this.isAbscissas()?this._scale.range([t.padding.min,e.innerWidth-t.padding.max]):this._scale.range([e.innerHeight-t.padding.min,t.padding.max])},n.prototype.updateScaleDomain=function(e){this._scale.domain(e)},n.prototype.getScaleDomain=function(){return this._scale?this._scale.domain():[0,1]},n.prototype.getExtent=function(e,t){var n=t.getByAxisSide(this.side),r=void 0;if(this.isAbscissas()){var i=t.getVisibleDatasets(),s=t.getAbsKey(),o=[];i.forEach(function(t){var n=e.sets[t].values;o=o.concat(n.map(function(e){return e[s]}))}),r=d3.extent(o)}else{var u=n.includeZero?[0]:[],a=n.includeZero?[0]:[];t.getVisibleSeriesBySide(this.side).forEach(function(n){var r=e.getDatasetValues(n,t);r.forEach(function(e){n.defined&&!n.defined(e)||(u.push(e.y0||e.y1),a.push(e.y1))})}),r=[d3.min(u),d3.max(a)],0===r[0]&&0===r[1]&&(r=[0,1])}return void 0!==n.min&&(r[0]=n.min),void 0!==n.max&&(r[1]=n.max),r},n.prototype.isAbscissas=function(){return-1!==[e.Options.AxisOptions.SIDE.X,e.Options.AxisOptions.SIDE.X2].indexOf(this.side)},n.prototype.isInLastHalf=function(e){var t=function(e){return e};e instanceof Date&&(t=function(e){return e.getTime()});var n=this._scale.domain(),r=n[0],i=n[1];return t(e)>t(r)+(t(i)-t(r))/2},n.prototype.createAxis=function(e){this.svg=e.append("g").attr("class","axis "+this.side+"-axis")},n.prototype.updateAxisOrientation=function(t){this.isAbscissas()?this.side===e.Options.AxisOptions.SIDE.X?t.orient("bottom"):t.orient("top"):this.side===e.Options.AxisOptions.SIDE.Y?t.orient("left"):t.orient("right")},n.prototype.updateAxisContainer=function(t){this.isAbscissas()?this.side===e.Options.AxisOptions.SIDE.X?this.svg.attr("transform","translate(0, "+t.innerHeight+")"):this.svg.attr("transform","translate(0, 0)"):this.side===e.Options.AxisOptions.SIDE.Y?this.svg.attr("transform","translate(0, 0)"):this.svg.attr("transform","translate("+t.innerWidth+", 0)"),this.softUpdate()},n.prototype.destroyAxis=function(){this.svg.remove()},n.prototype.invert=function(e){return this._scale.invert(e)},n.prototype.isTimeAxis=function(){return this.options.type===e.Options.AxisOptions.TYPE.DATE},n.prototype.getScale=function(){return this.options&&this.options.type===e.Options.AxisOptions.TYPE.DATE?d3.time.scale():this.options&&this.options.type===e.Options.AxisOptions.TYPE.LOG?d3.scale.log():d3.scale.linear()},n.prototype.getAxis=function(t,n){var r;return r=n.hasDynamicTicks()?e.svg.twoSpeedAxis().scale(t):d3.svg.axis().scale(t),n.configure(r),r},n.prototype.cloneAxis=function(){var t;return t=this.options&&this.options.hasDynamicTicks()?e.svg.twoSpeedAxis().ticks(this.d3axis.ticks()):d3.svg.axis().ticks(this.d3axis.ticks()[0]),t.scale(this.d3axis.scale()).orient(this.d3axis.orient()).tickValues(this.d3axis.tickValues()).tickSize(this.d3axis.tickSize())},n}(t.BaseFactory);t.Axis=n}(t=e.Factory||(e.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.create=function(){this.svg=this.factoryMgr.get("container").axes.insert("g",":first-child").attr("class","grid"),this.svg.append("g").classed("x-grid",!0),this.svg.append("g").classed("y-grid",!0),this.eventMgr.on("resize."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("pan."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("zoom-end."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("outer-world-domain-change."+this.key,this.softUpdate.bind(this))},t.prototype.softUpdate=function(){var e=this.factoryMgr.get("container"),t=e.getDimensions();if(this.xAxis){var n=this.svg.select(".x-grid");this.factoryMgr.get("transitions").isOn()&&(n=n.transition().call(this.factoryMgr.getBoundFunction("transitions","edit"))),n.attr("transform","translate(0, "+t.innerHeight+")").call(this.xAxis.tickSize(-t.innerHeight,0))}if(this.yAxis){var n=this.svg.select(".y-grid");this.factoryMgr.get("transitions").isOn()&&(n=n.transition().call(this.factoryMgr.getBoundFunction("transitions","edit"))),n.call(this.yAxis.tickSize(-t.innerWidth,0))}},t.prototype.update=function(e,t){var n=this.factoryMgr.get("container"),r=n.getDimensions();t.grid.x&&(this.xAxis=this.factoryMgr.get("x-axis").cloneAxis().tickSize(-r.innerHeight,0),this.svg.select(".x-grid").transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).attr("transform","translate(0, "+r.innerHeight+")").call(this.xAxis)),t.grid.y&&(this.yAxis=this.factoryMgr.get("y-axis").cloneAxis(),this.svg.select(".y-grid").transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(this.yAxis.tickSize(-r.innerWidth,0)))},t.prototype.destroy=function(){this.svg.remove()},t}(e.BaseFactory);e.Grid=t}(t=e.Factory||(e.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.isActive=!1}return __extends(t,e),t.prototype.create=function(){this.rect=this.factoryMgr.get("container").svg.append("rect").attr("class","chart-brush")},t.prototype.constrainOutgoingDomains=function(e){this.zoomOnX||delete e.x,this.zoomOnY||delete e.y},t.prototype.update=function(e,t){var n=this.factoryMgr.get("container").getDimensions(),r=n.margin,i=r.left,s=r.top;this.zoomOnX=t.zoom.x,this.zoomOnY=t.zoom.y,(this.zoomOnX||this.zoomOnY)&&(this.xStartFn=this.zoomOnX?function(e){return e}:function(e){return i},this.xEndFn=this.zoomOnX?function(e){return e}:function(e){return n.innerWidth+i},this.yStartFn=this.zoomOnY?function(e){return e}:function(e){return s},this.yEndFn=this.zoomOnY?function(e){return e}:function(e){return n.innerHeight+s},this.registerEvents(this.factoryMgr.get("container")))},t.prototype.show=function(e){var t=e.xStart,n=e.xEnd,r=e.yStart,i=e.yEnd;s=t>n?[n,t]:[t,n],t=s[0],n=s[1],o=r>i?[i,r]:[r,i],r=o[0],i=o[1],this.rect.attr({x:t,width:n-t,y:r,height:i-r}).style("opacity","1");var s,o},t.prototype.hide=function(){this.rect.style("opacity","0")},t.prototype.updateAxes=function(e){var t=e.xStart,n=e.xEnd,r=e.yStart,i=e.yEnd;p=t>n?[n,t]:[t,n],t=p[0],n=p[1],d=r>i?[i,r]:[r,i],r=d[0],i=d[1];var s=this.factoryMgr.get("container").getDimensions(),o=s.margin,u=o.left,a=o.top,f=this.factoryMgr.get("x-axis"),l=this.factoryMgr.get("x2-axis");f.setDomain([f.invert(t-u),f.invert(n-u)]),l.setDomain(f.getDomain());var c=this.factoryMgr.get("y-axis"),h=this.factoryMgr.get("y2-axis");c.setDomain([c.invert(i-a),c.invert(r-a)]),h.setDomain([h.invert(i-a),h.invert(r-a)]);var p,d},t.prototype.registerEvents=function(e){var t,n,r,i,s,o=this,u=function(e){return e+"."+o.key},a=function(){o.isActive=!1,o.hide(),void 0!==n&&void 0!==i&&(o.updateAxes({xStart:t,xEnd:n,yStart:r,yEnd:i}),o.eventMgr.trigger("zoom-end"),t=n=r=i=void 0,s()),o.eventMgr.on(u("window-mouseup"),null)};e.svg.on(u("mousedown"),function(){var e=d3.event;e.altKey&&(s=o.factoryMgr.turnFactoriesOff(["tooltip"]),o.isActive=!0,o.eventMgr.on(u("window-mouseup"),a),n=d3.mouse(e.currentTarget),t=n[0],r=n[1],t=o.xStartFn(t),r=o.yStartFn(r));var n}).on(u("mousemove"),function(){o.isActive&&(e=d3.mouse(d3.event.currentTarget),n=e[0],i=e[1],n=o.xEndFn(n),i=o.yEndFn(i),o.show({xStart:t,xEnd:n,yStart:r,yEnd:i}),o.eventMgr.trigger("zoom"));var e})},t}(e.BaseFactory);e.Zoom=t}(t=e.Factory||(e.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.isActive=!1,this.hasMoved=!1}return __extends(t,e),t.prototype.constrainOutgoingDomains=function(e){this.panOnX||delete e.x,this.panOnY||delete e.y},t.prototype.move=function(e,t){if(0!==e){var n=this.factoryMgr.get("x-axis"),r=this.factoryMgr.get("x2-axis");n.setDomain(n.range().map(function(t){return t+e}).map(n.invert,n)),r.setDomain(n.getDomain())}if(0!==t){var i=this.factoryMgr.get("y-axis"),s=this.factoryMgr.get("y2-axis");i.setDomain(i.range().map(function(e){return e+t}).map(i.invert,i)),s.setDomain(s.range().map(function(e){return e+t}).map(s.invert,s))}},t.prototype.update=function(e,t){var n=this;this.panOnX=t.pan.x,this.panOnY=t.pan.y;var r,i,s,o=this.factoryMgr.get("container"),u=function(e){return e+"."+n.key},a=function(){n.hasMoved&&n.eventMgr.trigger("pan-end"),s&&s(),n.isActive=n.hasMoved=!1,s=void 0,n.eventMgr.on(u("window-mouseup"),null),n.eventMgr.on(u("window-mousemove"),null)},f=function(){if(n.isActive){var e=d3.mouse(o.svg.node()),t=e[0],u=e[1],a=n.panOnX?r-t:0,f=n.panOnY?i-u:0;0===a&&0===f||(s||(s=n.factoryMgr.turnFactoriesOff(["tooltip","transitions"])),n.hasMoved=!0,n.move(a,f),n.eventMgr.trigger("pan")),l=[t,u],r=l[0],i=l[1]}var l};o.svg.on(u("mousedown"),function(){var e=d3.event;e.altKey||(n.isActive=!0,t=d3.mouse(e.currentTarget),r=t[0],i=t[1],n.eventMgr.on(u("window-mouseup"),a),n.eventMgr.on(u("window-mousemove"),f));var t})},t}(e.BaseFactory);e.Pan=t}(t=e.Factory||(e.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.duration=t.defaultDuration,this.ease="cubic"}return __extends(t,e),t.prototype.off=function(){e.prototype.off.call(this),this.duration=0},t.prototype.on=function(){e.prototype.on.call(this),this.duration=t.defaultDuration},t.prototype.enter=function(e){var t=this.duration,n=this.ease,r=e[0].length,i=function(e,n){return r?n/r*t:0};e.duration(t).delay(i).ease(n)},t.prototype.edit=function(e){var t=this.duration,n=this.ease,r=0;e.duration(t).delay(r).ease(n)},t.prototype.exit=function(e){var t=this.duration,n=this.ease,r=0;e.duration(t).delay(r).ease(n)},t.defaultDuration=250,t}(e.BaseFactory);e.Transition=t}(t=e.Factory||(e.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.create=function(){this.createContainer(this.factoryMgr.get("container").data),this.eventMgr.on("data-update."+this.type,this.update.bind(this)),this.eventMgr.on("pan."+this.type,this.softUpdate.bind(this)),this.eventMgr.on("zoom-end."+this.type,this.softUpdate.bind(this)),this.eventMgr.on("outer-world-domain-change."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("resize."+this.type,this.softUpdate.bind(this))},t.prototype.update=function(e,t){this.data=e,this.options=t,this.softUpdate()},t.prototype.getAxes=function(e){return{xAxis:this.factoryMgr.get("x-axis"),yAxis:this.factoryMgr.get(e.axis+"-axis")}},t.prototype.softUpdate=function(){var e=this.options.getSeriesByType(this.type).filter(function(e){return e.visible});this.updateSeriesContainer(e)},t.prototype.destroy=function(){this.svg.remove()},t.prototype.createContainer=function(e){this.svg=e.append("g").attr("class",this.type+t.containerClassSuffix)},t.prototype.updateSeriesContainer=function(e){var n=this,r=this.svg.selectAll("."+this.type+t.seriesClassSuffix).data(e,function(e){return e.id});r.enter().append("g").attr({"class":function(e){return n.type+t.seriesClassSuffix+" "+e.id}}),this.styleSeries(r),this.updateSeries(r,e),r.exit().remove()},t.prototype.updateSeries=function(e,t){var n=this;e.each(function(e,r){var s=d3.select(this);n.updateData(s,e,r,t.length)})},t.prototype.updateData=function(e,t,n,r){},t.prototype.styleSeries=function(e){},t.containerClassSuffix="-data",t.seriesClassSuffix="-series",t}(e.Factory.BaseFactory);t.SeriesFactory=n}(n=t.Series||(t.Series={}))}(t=e.Factory||(e.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(t){var n;!function(n){var r=function(t){function n(){t.apply(this,arguments),this.type=e.Options.SeriesOptions.TYPE.DOT}return __extends(n,t),n.prototype.updateData=function(e,t,n,r){var i=this.getAxes(t),s=i.xAxis,o=i.yAxis,u=this.data.getDatasetValues(t,this.options).filter(t.defined),a=2,f=e.selectAll("."+this.type).data(u,function(e){return""+e.x}),l=function(e){e.attr({r:function(e){return a},cx:function(e){return s.scale(e.x)},cy:function(e){return o.range()[0]}})},c=function(e){e.attr({cx:function(e){return s.scale(e.x)},cy:function(e){return o.scale(e.y1)}}).style("opacity",t.visible?1:0)};this.factoryMgr.get("transitions").isOn()?(f.enter().append("circle").attr("class",this.type).call(this.eventMgr.datumEnter(t,this.options)).call(this.eventMgr.datumOver(t,this.options)).call(this.eventMgr.datumMove(t,this.options)).call(this.eventMgr.datumLeave(t,this.options)).call(l).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).call(c),f.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(c),f.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).call(l).each("end",function(){d3.select(this).remove()})):(f.enter().append("circle").attr("class",this.type).call(this.eventMgr.datumEnter(t,this.options)).call(this.eventMgr.datumOver(t,this.options)).call(this.eventMgr.datumMove(t,this.options)).call(this.eventMgr.datumLeave(t,this.options)).call(c),f.call(c),f.exit().remove())},n.prototype.styleSeries=function(e){e.style({stroke:function(e){return e.color}})},n}(t.Series.SeriesFactory);n.Dot=r}(n=t.Series||(t.Series={}))}(t=e.Factory||(e.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(t){var n;!function(n){var r=function(t){function n(){t.apply(this,arguments),this.type=e.Options.SeriesOptions.TYPE.LINE}return __extends(n,t),n.prototype.updateData=function(e,t,n,r){e.classed("dashed",t.isDashed());var i=this.getAxes(t),s=i.xAxis,o=i.yAxis,u=this.data.getDatasetValues(t,this.options),a=d3.svg.line().defined(t.defined).x(function(e){return s.scale(e.x)}).y(o.range()[0]).interpolate(t.interpolation.mode).tension(t.interpolation.tension),f=d3.svg.line().defined(t.defined).x(function(e){return s.scale(e.x)}).y(function(e){return o.scale(e.y1)}).interpolate(t.interpolation.mode).tension(t.interpolation.tension),l=e.selectAll("."+this.type).data([u]);this.factoryMgr.get("transitions").isOn()?(l.enter().append("path").attr("class",this.type).attr("d",function(e){return a(e)}).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).attr("d",function(e){return f(e)}),l.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).attr("d",function(e){return f(e)}).style("opacity",t.visible?1:0),l.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).attr("d",function(e){return a(e)}).each("end",function(){d3.select(this).remove()})):(l.enter().append("path").attr("class",this.type).attr("d",function(e){return f(e)}),l.attr("d",function(e){return f(e)}).style("opacity",t.visible?1:0),l.exit().remove())},n.prototype.styleSeries=function(e){e.style({fill:"none",stroke:function(e){return e.color},"stroke-dasharray":function(e){return e.isDashed()?"10,3":void 0}})},n}(t.Series.SeriesFactory);n.Line=r}(n=t.Series||(t.Series={}))}(t=e.Factory||(e.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(t){var n;!function(n){var r=function(t){function n(){t.apply(this,arguments),this.type=e.Options.SeriesOptions.TYPE.AREA}return __extends(n,t),n.prototype.updateData=function(e,t,n,r){var i=this.getAxes(t),s=i.xAxis,o=i.yAxis,u=this.data.getDatasetValues(t,this.options),a=d3.svg.area().defined(t.defined).x(function(e){return s.scale(e.x)}).y0(o.range()[0]).y1(o.range()[0]).interpolate(t.interpolation.mode).tension(t.interpolation.tension),f=d3.svg.area().defined(t.defined).x(function(e){return s.scale(e.x)}).y0(function(e){return isNaN(o.scale(e.y0))?o.range()[0]:o.scale(e.y0)}).y1(function(e){return o.scale(e.y1)}).interpolate(t.interpolation.mode).tension(t.interpolation.tension),l=e.selectAll("."+this.type).data([u]);this.factoryMgr.get("transitions").isOn()?(l.enter().append("path").attr("class",this.type).attr("d",function(e){return a(e)}).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).attr("d",function(e){return f(e)}),l.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).attr("d",function(e){return f(e)}).style("opacity",t.visible?1:0),l.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).attr("d",function(e){return a(e)}).each("end",function(){d3.select(this).remove()})):(l.enter().append("path").attr("class",this.type).attr("d",function(e){return f(e)}),l.attr("d",function(e){return f(e)}).style("opacity",t.visible?1:0),l.exit().remove())},n.prototype.styleSeries=function(e){e.style({fill:function(e){return e.color},stroke:function(e){return e.color}})},n}(t.Series.SeriesFactory);n.Area=r}(n=t.Series||(t.Series={}))}(t=e.Factory||(e.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(t){var n;!function(n){var r=function(t){function n(){t.apply(this,arguments),this.type=e.Options.SeriesOptions.TYPE.COLUMN,this.gapFactor=.2,this.outerPadding=this.gapFactor/2*3,this.columnsWidth=0}return __extends(n,t),n.prototype.softUpdate=function(){var e=this.options.getSeriesByType(this.type).filter(function(e){return e.visible});this.updateColumnsWidth(e,this.options),this.updateColumnScale(e,this.options),this.updateSeriesContainer(e)},n.prototype.update=function(e,t){this.data=e,this.options=t;var n=t.getSeriesByType(this.type).filter(function(e){return e.visible});this.updateColumnsWidth(n,t),this.updateColumnScale(n,t),this.updateSeriesContainer(n)},n.prototype.updateColumnsWidth=function(t,n){var r=this.factoryMgr.get("x-axis"),i=this.data.getDatasets(t,n),s=e.Utils.Data.getMinDistance(i,r,"x");this.columnsWidth=s<Number.MAX_VALUE?s/t.length:10},n.prototype.updateColumnScale=function(e,t){var n=this.columnsWidth*e.length/2;this.innerXScale=d3.scale.ordinal().domain(e.map(function(e){return e.id})).rangeBands([-n,n],0,.1)},n.prototype.getTooltipPosition=function(e){return this.innerXScale(e.id)+this.innerXScale.rangeBand()/2},n.prototype.updateData=function(e,t,n,r){var i=this,s=this.getAxes(t),o=s.xAxis,u=s.yAxis,a=this.data.getDatasetValues(t,this.options).filter(t.defined),f=function(e){return o.scale(e.x)+i.innerXScale(t.id)},l=function(e){e.attr({x:f,y:function(e){return u.scale(e.y0)},width:i.innerXScale.rangeBand(),height:0})},c=function(e){e.attr({x:f,y:function(e){return e.y1>0?u.scale(e.y1):u.scale(e.y0)},width:i.innerXScale.rangeBand(),height:function(e){return Math.abs(u.scale(e.y0)-u.scale(e.y1))}}).style("opacity",t.visible?1:0)},h=e.selectAll("."+this.type).data(a,function(e){return""+e.x});this.factoryMgr.get("transitions").isOn()?(h.enter().append("rect").attr("class",this.type).call(this.eventMgr.datumEnter(t,this.options)).call(this.eventMgr.datumOver(t,this.options)).call(this.eventMgr.datumMove(t,this.options)).call(this.eventMgr.datumLeave(t,this.options)).call(l).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).call(c),h.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(c),h.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).call(l).each("end",function(){d3.select(this).remove()})):(h.enter().append("rect").attr("class",this.type).call(this.eventMgr.datumEnter(t,this.options)).call(this.eventMgr.datumOver(t,this.options)).call(this.eventMgr.datumMove(t,this.options)).call(this.eventMgr.datumLeave(t,this.options)).call(c),h.call(c),h.exit().remove())},n.prototype.styleSeries=function(e){e.style({fill:function(e){return e.color},stroke:function(e){return e.color},"stroke-width":1})},n}(t.Series.SeriesFactory);n.Column=r}(n=t.Series||(t.Series={}))}(t=e.Factory||(e.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t;!function(e){var t=function(e){function t(t,n,r){e.call(this),this.scope=t,this.attributes=n,this.$parse=r}return __extends(t,e),t.prototype.create=function(){this.unregisteringFunctions=[],this.sanitizeAttributes(),this.syncTooltips(),this.syncDomainsChange(),this.syncDatumEvents()},t.prototype.sanitizeAttributes=function(){var e=this.attributes,t=e.tooltipSyncKey,n=e.domainsSyncKey;if(t&&n&&t===n)throw new Error("Heterogeneous sync keys can't have the same value.")},t.prototype.syncDatumEvents=function(){var e=this,t=this.eventMgr;if(this.attributes.onClick){var n=this.$parse(this.attributes.onClick);t.on("click.sync-layer",function(t,r,i,s){n(e.scope.$parent,{row:t,index:r,series:i,options:s})})}},t.prototype.syncTooltips=function(){var e=this,t=this.eventMgr;this.attributes.tooltipSyncKey&&(this.unregisteringFunctions.push(this.scope.$root.$on(this.attributes.tooltipSyncKey,function(e,n){t.triggerDataAndOptions("outer-world-hover",n)})),t.on("container-move.sync-layer",function(t){e.scope.$emit(e.attributes.tooltipSyncKey,e.factoryMgr.get("container").getCoordinatesFromEvent(t))}),t.on("container-out.sync-layer",function(){e.scope.$emit(e.attributes.tooltipSyncKey,{x:void 0,y:void 0})}))},t.prototype.syncDomainsChange=function(){var e=this,t=this.eventMgr,n=[],r=this.factoryMgr.get("x-axis"),i=this.factoryMgr.get("y-axis");if(this.attributes.onDomainsChange){var s=this.$parse(this.attributes.onDomainsChange);n.push(function(t,n){var r=n.isEndEvent;r&&s(e.scope.$parent,{$domains:t})})}this.attributes.domainsSyncKey&&(this.unregisteringFunctions.push(this.scope.$root.$on(this.attributes.domainsSyncKey,function(n,s,o){n.targetScope!==e.scope&&(s.x&&s.y||(s=angular.copy(s)),s.x||(s.x=r.getScaleDomain()),s.y||(s.y=i.getScaleDomain()),"zoom-end"===o?(t.trigger("outer-world-domain-change",s),e.factoryMgr.turnFactoriesOn(["tooltip"])):"zoom"===o?e.factoryMgr.turnFactoriesOff(["tooltip"]):"pan"===o||"pan-end"===o?(e.factoryMgr.turnFactoriesOff(["transitions","tooltip"]),t.trigger("outer-world-domain-change",s),"pan-end"===o&&e.factoryMgr.turnFactoriesOn(["transitions","tooltip"])):"zoom-pan-reset"===o&&t.trigger("zoom-pan-reset",!1))})),n.push(function(t,n){var r=n.type;e.scope.$emit(e.attributes.domainsSyncKey,t,r)}));var o=function(){return{x:r.getScaleDomain(),y:i.getScaleDomain()}},u=function(e,t){return n.forEach(function(n){return n(e,t)})};t.on("pan.sync-layer",function(){var t=o();e.factoryMgr.get("pan").constrainOutgoingDomains(t),u(t,{type:"pan"})}),t.on("pan-end.sync-layer",function(){var t=o();e.factoryMgr.get("pan").constrainOutgoingDomains(t),u(t,{type:"pan-end",isEndEvent:!0})}),t.on("zoom.sync-layer",function(){var t=o();e.factoryMgr.get("zoom").constrainOutgoingDomains(t),u(t,{type:"zoom",isEndEvent:!1})}),t.on("zoom-end.sync-layer",function(){var t=o();e.factoryMgr.get("zoom").constrainOutgoingDomains(t),u(t,{type:"zoom-end",isEndEvent:!0})}),t.on("zoom-pan-reset.sync-layer",function(e){e&&u(o(),{type:"zoom-pan-reset",isEndEvent:!0})})},t.prototype.destroy=function(){for(var e;e=this.unregisteringFunctions.pop();)e()},t}(e.BaseFactory);e.SyncLayer=t}(t=e.Factory||(e.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(e){var t=function(){function t(t,n,r,i){var s=this;this.$window=t,this.$parse=n,this.$timeout=r,this.$rootScope=i,this.scope={data:"=",options:"=",styles:"=",hoveredCoordinates:"="},this.restrict="E",this.replace=!0,this.template="<div></div>",this.link=function(t,n,r){var i,o,u=new e.Utils.EventManager,a=new e.Utils.FactoryManager;u.init(e.Utils.EventManager.EVENTS),a.registerMany([["container",e.Factory.Container,n[0]],["tooltip",e.Factory.Tooltip,n[0]],["legend",e.Factory.Legend,n[0]],["transitions",e.Factory.Transition],["x-axis",e.Factory.Axis,e.Options.AxisOptions.SIDE.X],["x2-axis",e.Factory.Axis,e.Options.AxisOptions.SIDE.X2],["y-axis",e.Factory.Axis,e.Options.AxisOptions.SIDE.Y],["y2-axis",e.Factory.Axis,e.Options.AxisOptions.SIDE.Y2],["grid",e.Factory.Grid],["pan",e.Factory.Pan],["zoom",e.Factory.Zoom],["sync-layer",e.Factory.SyncLayer,t,r,s.$parse],["series-area",e.Factory.Series.Area],["series-column",e.Factory.Series.Column],["series-line",e.Factory.Series.Line],["series-dot",e.Factory.Series.Dot]]),a.all().forEach(function(e){return e.instance.init(e.key,u,a)});var f=void 0===t.options,l=function(){o=new e.Options.Options(angular.copy(t.options)),i=new e.Utils.Data(t.data),f&&(f=!1,u.trigger("create",o)),u.update(i,o),u.trigger("update",i,o)};f||u.trigger("create",new e.Options.Options(angular.copy(t.options)));var c=function(e){e&&(i.fromJS(e),a.turnFactoriesOff(["transitions"]),u.trigger("data-update",i,o),a.turnFactoriesOn(["transitions"]),u.trigger("update",i,o))};t.$watch("options",l,!0),t.$watch("data",c,!0),u.on("legend-click.directive",function(e){var n=t.options.series.filter(function(t){return t.id===e.id})[0];n.visible=e.getToggledVisibility(),t.$apply()}),u.on("pan.directive",function(){a.get("container").svg.classed("panning",!0)}),u.on("pan-end.directive",function(){a.get("container").svg.classed("panning",!1)});var h=function(){if(!n||!n[0])return{};var e=n[0].parentElement.getBoundingClientRect();return{height:e.height,width:e.width,left:e.left,right:e.right,bottom:e.bottom,top:e.top}},p=e.Utils.FunctionUtils.debounce(function(){u.trigger("resize",n[0].parentElement)},50);t.$watch(h,p,!0);var d=e.Utils.FunctionUtils.debounce(function(){return t.$apply()},50);angular.element(s.$window).on("resize",d),t.$on("$destroy",function(){u.trigger("destroy"),angular.element(s.$window).off("resize",d)})}}return t}();e.LineChart=t}(n3Charts||(n3Charts={})),angular.module("n3-line-chart",[]).directive("linechart",["$window","$parse","$timeout","$rootScope",function(e,t,n,r){return new n3Charts.LineChart(e,t,n,r)}]);