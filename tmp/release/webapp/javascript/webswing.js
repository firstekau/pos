webswingRequirejs.define(["jquery","webswing-util","webswing-polyfill","webswing-base","webswing-socket","webswing-files","webswing-dialog","webswing-login","webswing-canvas","webswing-identity","webswing-jslink","webswing-clipboard","webswing-playback","webswing-input","webswing-touch","webswing-inject","webswing-translate","webswing-ping"],function(t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){function x(e){e=e!=null?e:w;var n={},r=t("[data-webswing-instance]");r.each(function(r,i){var s=t(i).data("webswingInstance"),o=t(i).data("webswingActive");if(!o){var u;e[s]!=null&&e[s].options!=null&&(t(i).data("webswingOptions",e[s].options),e[s].options.customization!=null&&typeof e[s].options.customization=="function"&&(u=e[s].options.customization)),t(i).find("#loading").remove();var a=T(t(i),u);t(i).attr("data-webswing-active","true"),s!=null&&(n[s]=a)}});for(var i in n)e[i]=t.extend(e[i],n[i])}function T(e,t){var n=new m;n.module("webswing",new N(e)),n.module("dialog",new u),n.module("canvas",new f),n.module("base",new i),n.module("input",new d),n.module("touch",new v),n.module("socket",new s),n.module("files",new o),n.module("login",new a),n.module("identity",new l),n.module("jslink",new c),n.module("clipboard",new h),n.module("playback",new p),n.module("translate",new g),n.module("ping",new y);var r={start:"webswing.start",disconnect:"webswing.disconnect",configure:"webswing.configure",kill:"base.kill",setControl:"webswing.setControl",repaint:"base.repaint"};return n.module("external",{provides:r,injects:r}),t!=null&&t(n),n.injectAndVerify(),r}function N(e){function s(){return{rootElement:o(e),autoStart:!1,applicationName:null,args:null,connectionUrl:location.origin+location.pathname,mirror:!1,recordingPlayback:!1,typedArraysSupported:E,binarySocket:!0,recording:!1,debugPort:null,javaCallTimeout:3e3,documentBase:document.location.origin+document.location.pathname,ieVersion:n.detectIE(),isMac:n.detectMac(),clientId:null,viewId:null,appName:null,hasControl:!1,mirrorMode:!1,canPaint:!1,virtualKB:!1,debugLog:!1}}function o(e){return e.addClass("webswing-element")}function u(){if(!n.checkCookie()){i.showDialog(i.cookiesDisabledDialog);return}i.login(function(){i.showDialog(i.initializingDialog),i.connect()})}function a(){i.disconnect(),i.disposeIdentity(),i.start()}function f(){i.disconnect(),i.start()}function l(){i.disposeFileDialog(),i.disposeBase(),i.disposeInput(),i.disposeTouch(),i.disposeCanvas(),i.disposeSocket(),i.disposeCopyBar()}function c(e,t){var n=i.cfg;e=e!=null?e:p(n.rootElement),e!=null&&(n.autoStart=e.autoStart!=null?JSON.parse(e.autoStart):n.autoStart,n.applicationName=e.applicationName!=null?e.applicationName:n.applicationName,n.securityToken=e.securityToken!=null?e.securityToken:n.securityToken,n.realm=e.realm!=null?e.realm:n.realm,n.args=e.args!=null?e.args:n.args,n.binarySocket=e.binarySocket!=null?JSON.parse(e.binarySocket):n.binarySocket,n.recording=e.recording!=null?JSON.parse(e.recording):n.recording,n.clientId=e.clientId!=null?e.clientId:n.clientId,n.mirror=e.mirrorMode!=null?JSON.parse(e.mirrorMode):n.mirror,n.connectionUrl=e.connectionUrl!=null?e.connectionUrl:n.connectionUrl,n.debugPort=e.debugPort!=null?e.debugPort:n.debugPort,n.debugLog=e.debugLog!=null?JSON.parse(e.debugLog):n.debugLog,n.javaCallTimeout=e.javaCallTimeout!=null?parseInt(e.javaCallTimeout,10):n.javaCallTimeout,n.connectionUrl.substr(n.connectionUrl.length-1)!=="/"&&(n.connectionUrl=n.connectionUrl+"/"),e.recordingPlayback!=null&&(n.recordingPlayback=n.applicationName=e.recordingPlayback,i.showPlaybackControls())),t=t!=null?t:d(n.rootElement);if(t!=null){n.params=[];for(var r in t)typeof t[r]=="string"&&n.params.push({name:r,value:t[r]})}}function h(e){i.cfg.hasControl=e?!0:!1}function p(e){var t=e.data("webswingOptions");return t}function d(e){var n={},r=t(e).find("webswing-param");for(var i=0;i<r.length;i++){var s=r[i].getAttribute("name"),o=r[i].getAttribute("value");s!=null&&(n[s]=o)}return n}var r=this,i;r.injects=i={cfg:"webswing.config",start:"webswing.start",disconnect:"webswing.disconnect",login:"login.login",connect:"socket.connect",showDialog:"dialog.show",readyDialog:"dialog.content.readyDialog",initializingDialog:"dialog.content.initializingDialog",cookiesDisabledDialog:"dialog.content.cookiesDisabledDialog",disposeIdentity:"identity.dispose",disposeBase:"base.dispose",disposeCanvas:"canvas.dispose",disposeTouch:"touch.dispose",disposeInput:"input.dispose",disposeSocket:"socket.dispose",disposeFileDialog:"files.close",disposeCopyBar:"clipboard.dispose",showPlaybackControls:"playback.showControls"},r.provides={config:s(),start:u,newSession:a,reTrySession:f,disconnect:l,setControl:h,configure:c},r.ready=function(){c(),i.cfg.autoStart?i.start():i.showDialog(i.readyDialog)}}var b=t("[data-webswing-global-var]"),w={},E=r();if(b!=null&&b.length!==0){var S=b.data("webswingGlobalVar");w=window[S]={scan:x,bootstrap:T,utils:n,$:t},x(window)}else x(window)});